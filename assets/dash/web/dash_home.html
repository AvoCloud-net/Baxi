<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Baxi Dashboard</title>
    <meta property="og:title" content="Avocloud.net â€” Baxi">
    <meta property="og:description" content="This is the home page of the Baxi dashboard.">
    <meta property="og:url" content="https://baxi.avocloud.net/">
    <meta property="og:color" content="#DC143C">

    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/basecoat-css@0.3.10-beta.2/dist/basecoat.cdn.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='main.css') }}">
    <script src="https://avocloud.net/assets/js/theme.js"></script>
</head>

<body>
    <div id="gradientbar"></div>
    <button class="theme-toggle" onclick="toggleTheme()" title="Toggle theme">
        <svg id="theme-icon" viewBox="0 0 24 24"></svg>
    </button>

    <div class="button-group local-button-group" data-orientation="vertical">
        <button type="button" class="btn-lg-outline p-6">
            <img class="size-8 shrink-0 object-cover rounded-full" alt="@{{user.name}}" src={{user.avatar_url}} />
            {{user.name}}
        </button>
        <hr role="separator" />
        <button onclick="location.href = '/logout/'" class="btn-lg-outline">
            <svg class="lucide" viewBox="0 0 24 24">
                <path d="m16 17 5-5-5-5"/>
                <path d="M21 12H9"/>
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
            </svg>
            Log-out
        </button>
    </div>

    <div class="max-w-6xl mx-auto px-4 sm:px-6">
        <div class="page-header">
            <h1 class="text-3xl font-bold">{{greeting}}</h1>
        </div>

        <main class="pb-24">

            <!-- Baxi Stats -->
            <section class="pb-16" id="stats">
                <div class="section-label">BAXI STATS</div>
                <div class="card">
                    <header>
                        <h2 class="text-xl font-semibold flex items-center gap-2">
                            <svg class="lucide" viewBox="0 0 24 24">
                                <line x1="18" y1="20" x2="18" y2="10"/>
                                <line x1="12" y1="20" x2="12" y2="4"/>
                                <line x1="6" y1="20" x2="6" y2="14"/>
                            </svg>
                            Baxi Stats
                        </h2>
                        <p class="text-muted">Here you can see some statistics about Baxi's usage.</p>
                    </header>
                    <section>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div class="card">
                                <header>
                                    <h2 class="text-base font-semibold flex items-center gap-2">
                                        <svg class="lucide" viewBox="0 0 24 24">
                                            <rect x="2" y="2" width="20" height="8" rx="2" ry="2"/>
                                            <rect x="2" y="14" width="20" height="8" rx="2" ry="2"/>
                                            <line x1="6" y1="6" x2="6.01" y2="6"/>
                                            <line x1="6" y1="18" x2="6.01" y2="18"/>
                                        </svg>
                                        Guilds
                                    </h2>
                                </header>
                                <section>
                                    <p class="text-muted">
                                        Currently active in <strong>{{ "{:,}".format(stats.get("guild_count", 0)) }}</strong>
                                        Discord server{{ 's' if stats.get("guild_count", 0) != 1 else '' }}.
                                    </p>
                                </section>
                            </div>

                            <div class="card">
                                <header>
                                    <h2 class="text-base font-semibold flex items-center gap-2">
                                        <svg class="lucide" viewBox="0 0 24 24">
                                            <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
                                            <circle cx="9" cy="7" r="4"/>
                                            <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
                                            <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
                                        </svg>
                                        Users
                                    </h2>
                                </header>
                                <section>
                                    <p class="text-muted">
                                        Serving <strong>{{ "{:,}".format(stats.get("user_count", 0)) }}</strong>
                                        unique user{{ 's' if stats.get("user_count", 0) != 1 else '' }}.
                                    </p>
                                </section>
                            </div>

                            <div class="card">
                                <header>
                                    <h2 class="text-base font-semibold flex items-center gap-2">
                                        <svg class="lucide" viewBox="0 0 24 24">
                                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
                                        </svg>
                                        Processed Messages
                                    </h2>
                                </header>
                                <section>
                                    <p class="text-muted">
                                        Baxi has processed <strong>{{ "{:,}".format(stats.get("prossesed_messages", 0)) }}</strong>
                                        message{{ 's' if stats.get("prossesed_messages", 0) != 1 else '' }} since 1st of December 2025.
                                    </p>
                                </section>
                            </div>
                        </div>
                    </section>
                </div>
            </section>

            <!-- Access -->
            <section class="pb-16" id="access">
                <div class="section-label">ACCESS</div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

                    <div class="card">
                        <header>
                            <h2 class="text-xl font-semibold flex items-center gap-2">
                                <svg class="lucide" viewBox="0 0 24 24">
                                    <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/>
                                    <polyline points="10 17 15 12 10 7"/>
                                    <line x1="15" y1="12" x2="3" y2="12"/>
                                </svg>
                                Guild Log-in
                            </h2>
                            <p class="text-muted">Select the server for which you want to change settings.</p>
                        </header>
                        <section>
                            <form action="/" method="get" class="login-form grid gap-4">
                                <select name="guild_login" id="guild_login" class="select w-full" required>
                                    <option value="">-- Please select --</option>
                                    {% for id, name in managed_guilds.items() %}
                                    <option value="{{ id }}">{{ name }}</option>
                                    {% endfor %}
                                </select>
                                <button type="submit" class="btn-primary submit-btn w-full">
                                    <span class="btn-text">
                                        <svg class="lucide" viewBox="0 0 24 24">
                                            <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/>
                                            <polyline points="10 17 15 12 10 7"/>
                                            <line x1="15" y1="12" x2="3" y2="12"/>
                                        </svg>
                                        Log-in
                                    </span>
                                    <svg viewBox="0 0 24 24" class="spinner hidden animate-spin" width="16" height="16"
                                        stroke="currentColor" fill="none" stroke-width="2"
                                        stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 12a9 9 0 1 1-6.219-8.56"/>
                                    </svg>
                                </button>
                            </form>
                        </section>
                    </div>

                    <div class="card">
                        <header>
                            <h2 class="text-xl font-semibold flex items-center gap-2">
                                <svg class="lucide" viewBox="0 0 24 24">
                                    <path d="M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z"/>
                                    <path d="M12 15h.01"/>
                                    <path d="M12 7v4"/>
                                </svg>
                                Chatfilter Log
                            </h2>
                            <p class="text-muted">Enter the ID of a chatfilter log entry to view its details.</p>
                        </header>
                        <section>
                            <form action="/" method="get" class="login-form grid gap-4">
                                <input type="text" name="id_chatfilter" id="id_chatfilter"
                                    placeholder="Log entry ID" class="w-full" required>
                                <button type="submit" class="btn-primary submit-btn w-full">
                                    <span class="btn-text">
                                        <svg class="lucide" viewBox="0 0 24 24">
                                            <circle cx="11" cy="11" r="8"/>
                                            <path d="m21 21-4.35-4.35"/>
                                        </svg>
                                        View
                                    </span>
                                    <svg viewBox="0 0 24 24" class="spinner hidden animate-spin" width="16" height="16"
                                        stroke="currentColor" fill="none" stroke-width="2"
                                        stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M21 12a9 9 0 1 1-6.219-8.56"/>
                                    </svg>
                                </button>
                            </form>
                        </section>
                    </div>

                </div>
            </section>

            <footer class="site-footer">
                <p>Avocloud.net &mdash; Baxi Dashboard</p>
            </footer>

        </main>
    </div>

    <script src="{{ url_for('static', filename='scripts/main.js') }}"></script>
    <script>
        document.querySelectorAll('.login-form').forEach(form => {
            form.addEventListener('submit', function () {
                const button = form.querySelector('.submit-btn');
                const spinner = button.querySelector('.spinner');
                const text = button.querySelector('.btn-text');
                button.disabled = true;
                spinner.classList.remove('hidden');
                text.textContent = "";
            });
        });
    </script>

</body>

</html>
